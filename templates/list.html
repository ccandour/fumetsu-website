{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}


{% block scripts %}
    {{ search_term|json_script:"search-term" }}
    {{ search_tags|json_script:"search-tags" }}
    <script src="{% static '/js/jquery.waypoints.js' %}"></script>
    <script src="{% static '/js/infinite.js' %}"></script>
    <script src="{% static '/js/search.js' %}" defer></script>
{% endblock scripts %}

{% block content %}
<div class="col-12 col-md-7 col-lg-9">
	<h2 class="mb-5" >Lista Anime</h2>
    <div class="d-flex flex-column align-items-center mb-4">
        <form id="search-form" class="d-flex flex-row gap-4 w-md-50 align-items-center" autocomplete="off">
            {% csrf_token %}
            <input id="search-input" type="text" class="form-control form-control-lg w-sm-100" placeholder="Nazwa anime">
            <!-- First dropdown -->
            <div class="dropdown">
                <button class="btn btn-secondary btn-lg dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" data-bs-auto-close="outside" data-bs-offset="0, 10">
                    Filtruj
                </button>
                <ul id="tags-filter" class="dropdown-menu">
                    <li><h6 class="dropdown-header">Gatunki</h6></li>
                    {% for tag in tags %}
                    <li class="dropdown-item">
                        <label class="form-check-label w-75 text-start d-" for="tags-{{ forloop.counter }}">{{ tag }}</label>
                        <input class="form-check-input float-end" type="checkbox" value="" id="tags-{{ forloop.counter }}">
                    </li>
                    {% endfor %}
                </ul>
            </div>

        </form>
    </div>
</div>

<!-- Actual list of anime (managed by search.js) -->
<div id="results-box" class=" infinite-container d-flex flex-column col-12 col-md-7 col-lg-9 anime-list gap-3"></div>
<!-- Invisible button to trigger infinite scrolling -->
<button id="infinite-trigger" class="d-none infinite-more-link"></button>

{% endblock content %}