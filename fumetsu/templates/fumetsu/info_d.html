{% extends "fumetsu/base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}
    
    <div class="col-12 col-lg-8 alt-bg float-left">
        <h2 >{{ content.title }}</h2>
    <img class="info-img float-left" src="{{ content.image.url }}">
            <p class="float-right new-date">{{ content.date_posted|date:"d.m.o" }}</p>
            <div class="clearfix"></div>
            <p>{{ content.content|safe }}</p>
        </div>
        
   <div class="col-12 col-lg-8 float-left">
            <div class="comments">
            <h5>Sekcja komentarzy:</h5>
            {% if  user.is_authenticated %}
            <form method="POST">
                {% csrf_token %}
                <div class="box_cr_com">
                    <div class="com_cr_cont">
                        {{ form|crispy }}
                    </div>
                    <button class="btn btn-op float-right" name="com_cr_bt">Wyślij komentarz</button>
                </div>
                <div class="clearfix"></div>
            </form>
            {% endif %}
            </div>
            <div id="Section_comm">
                {% for com in comment %}        
                    <div class="box_com ">
                        <div class="com_aut">           
                            <img class="com_img float-left" src="{{ com.author.profile.image.url }}">
                            <div class="com_nick float-left"><a href="{% url 'user-inf' com.author %}">{{com.author}}</a></div>

                            {% if com.author == user %}
                            <div class="dropleft float-right">
                                <a class="com_more" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <i class="fas fa-ellipsis-v"></i>
                                </a>
                                    <div class="dropdown-menu com_edit" aria-labelledby="navbarDropdown">
                                        <div class="text-center">
                                        <a href="" class="bt_com_sh" data-toggle="modal" data-target="#modalComRe">Edytuj</a>
                                        </div>
                                        <div class="text-center">
                                        <a href="" class="bt_com_del" data-toggle="modal" data-target="#modalComDel">Usuń</a>
                                        </div>
                                    </div>
                                </div>
                                {% endif %}

                            <div class="com_date float-right">{{com.date_posted}}</div>
                        </div>
                        <div class="com_cont">
                            
                            <div class="com_val">
                                
                                <br>{{com.content}}
                            </div>      
                            <input type="hidden" name="idd" value="{{com.pk}}" class="pdk">
                        </div>
                    </div>  
                {% endfor %}
            </div>

<div class="modal fade" id="modalComRe" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Edytuj Komentarz</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        </div>
        <form method="POST">
                {% csrf_token %}
                <div class="box_up_com">
                    <div class="com_up_cont cont_edit">                                                 {{ com_ed|crispy }} 
                        <input type="hidden" name="idd" value="" class="pdk">
                    </div>
                    <button class="btn btn-op btn-edit" name="com_up_bt">Edytuj</button>
                </div>
            </form> 
        
    </div>
  </div>
</div>

<div class="modal fade" id="modalComDel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Usuń komentarz</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        </div>
        <h5 class="modal-title w-100 font-weight-bold">Na pewno chcesz usnąć komentarz?</h5>
        <div class="com_up_div">
            <form method="POST">
                {% csrf_token %}
                <div class="box_up_com">
                    <div class="com_up_cont">                                                           
                        <input type="hidden" name="idd" value="" class="pdk">
                        </div>
                    <button class="btn btn-danger btn-edit" name="com_up_del">Usuń</button>
                </div>
            </form> 
        </div>
    </div>
  </div>
</div>

</div>

{% endblock content %}